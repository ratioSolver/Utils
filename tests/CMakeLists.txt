add_executable(utils_lib_tests test_utils.cpp)
target_link_libraries(utils_lib_tests PRIVATE utils)
if(MSVC)
    target_compile_options(utils_lib_tests PRIVATE /W4 /fsanitize=address)
else()
    target_compile_options(utils_lib_tests PRIVATE -Wall -Wextra -Wpedantic -fsanitize=address,undefined)
    target_link_options(utils_lib_tests PRIVATE -fsanitize=address,undefined)
endif()

add_executable(crypto_tests test_crypto.cpp)
target_link_libraries(crypto_tests PRIVATE utils)
if(MSVC)
    target_compile_options(crypto_tests PRIVATE /W4 /fsanitize=address)
else()
    target_compile_options(crypto_tests PRIVATE -Wall -Wextra -Wpedantic -fsanitize=address,undefined)
    target_link_options(crypto_tests PRIVATE -fsanitize=address,undefined)
endif()

add_test(NAME UTILS_LibTest COMMAND utils_lib_tests WORKING_DIRECTORY ${CMAKE_BINARY_DIR})
add_test(NAME CryptoTest COMMAND crypto_tests WORKING_DIRECTORY ${CMAKE_BINARY_DIR})